plugins {
    id 'fabric-loom' version '1.10.1'
    id 'maven-publish'
    id 'com.github.johnrengelman.shadow' version '8.1.1'
}

// ... rest of your configuration ...

configurations {
    shadow
    implementation.extendsFrom shadow
}

dependencies {
    // ✅ Core Fabric dependencies
    minecraft "com.mojang:minecraft:${project.minecraft_version}"
    mappings "net.fabricmc:yarn:${project.yarn_mappings}:v2"
    modImplementation "net.fabricmc:fabric-loader:${project.loader_version}"
    modImplementation "net.fabricmc.fabric-api:fabric-api:${project.fabric_version}"

    // ✅ External dependencies to be shadowed
    shadow "net.sf.trove4j:trove4j:3.0.3"
    shadow "se.llbit:jo-nbt:1.2.0"
    shadow "com.github.Vatuu:discord-rpc:1.6.2"
    shadow "dev.dejvokep:boosted-yaml:${project.boosted_yaml_version}"

    // ✅ Regular dependencies (not shadowed)
    implementation "net.dv8tion:JDA:${project.jda_version}"
    implementation "mysql:mysql-connector-java:${project.mysql}"
    implementation "io.netty:netty-all:${project.netty}"
}

// ... rest of your configuration ...

shadowJar {
    configurations = [project.configurations.shadow]
    archiveClassifier.set("dev-shadow")
    // Exclude Minecraft and Fabric classes from shadow jar
    dependencies {
        exclude(dependency('com.mojang:minecraft:.*'))
        exclude(dependency('net.fabricmc:.*'))
        exclude(dependency('net.fabricmc.fabric-api:.*'))
    }
}

remapJar {
    dependsOn shadowJar
    inputFile.set(shadowJar.archiveFile)
    archiveClassifier.set(null)
}
